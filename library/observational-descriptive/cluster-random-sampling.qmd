# Cluster random sampling {.unnumbered}


```{r}
#| echo: false
#| include: false
#| purl:  false
source("scripts/before_chapter_script.R")
```

:::: {.ddbox}
We declare a design in which a researcher takes a clustered random sample of a population and uses the design to ask whether they should invest in sampling more clusters or in more individuals per cluster. The design includes a budget constraint that affects how many can be sampled within clusters as a function of the number of clusters sampled.
::::

Researchers often cannot randomly sample at the individual level because it may, among other reasons, be too costly or logistically impractical. Instead, they may choose to sample clusters at random first, then randomly sample units within clusters. Clusters might be schools, localities, or households.

How does clustering change the research design relative to the individual-level design? First, we need to elaborate the model $M$ to make the clustering hierarchy explicit. In the declaration below, we imagine our research site is two states in Nigeria. Localities are nested within states and individuals are nested within localities. Second, we want to respect this hierarchy when thinking about the distribution of outcomes. Individuals living in the same locality are likely to share political viewpoints, either through the explicit transmission of political views or because of common exposure to political influence. The "intra-cluster correlation" or ICC is an extremely important statistic for the design of cluster-sampled studies. It describes what fraction of the total variation in the outcome can be attributed to the across-cluster differences in average outcomes. 

In the declaration below, the latent outcome `Y_star` describes subject's latent political preferences. This latent outcome is a function of locality differences and individual differences. The variances of these two shocks (difference parameters) are determined by the `ICC` parameter. If ICC were equal to 1, the variance across localities would be equal to 1, and all individuals within a locality would have exactly the same political preferences. If ICC were equal to zero, then the variation in preferences would be entirely at the individual level. 

```{r, file = "scripts_declarations/declaration_15.3a.R"}
```

Many different cluster sampling designs are possible, but a standard choice is a two-stage design in which first, some but not all clusters are sampled, and second, some but not all units within a cluster are sampled. The sampling at either stage may be stratified by covariates at the appropriate level. The first stage can be stratified by cluster-level covariates and the second stage can be stratified by individual-level covariates in order to improve precision. In this declaration, we form cluster-level strata by state.

The two stage random-sampling design raises an important tradeoff: Should we invest in sampling more clusters or in more individuals per cluster? Typically, adding the marginal cluster is more expensive than adding the marginal individual. We formalize the tradeoff with a "budget function" that returns the largest individual level inclusion probability that is budget-compatible with a given cluster sampling probability:

```{r, file = "scripts_declarations/declaration_15.3b.R"}
```

We use the output of this function to determine the probability of an individual being sampled, conditional on their cluster being sampled. 

Lastly, the answer strategy must also respects the data strategy by clustering standard errors at the highest level at which units are sampled, which in this case is the locality.

::: {#def-ch15num3} 

## Cluster random sampling design

```{r, file = "scripts_declarations/declaration_15.3c.R"}
```

:::

We redesign Declaration @def-ch15num3 over various levels of the cluster-level probability of sampling, which in turn sets the probability of sampling at the individual level. Figure @fig-ch15num3 shows that for a good while, adding additional clusters yields precision gains. At some point, however, the cost to sample size within cluster is too large, and we start seeing precision loss around a probability of 0.75 of a cluster being sampled. The precise combination of design parameters that minimize the standard deviation of the sampling distribution will depend on nearly every aspect of the design declaration, but the most important are the total budget, the relative costs of clusters and individuals, and the ICC. When the ICC is zero, we should invest in few clusters and many individuals. When the ICC is one, we should invest in many clusters and few individuals.

::: {#lem-ch15num3} 

## Cluster random sampling diagnosis

```{r}
#| eval: false

designs <- redesign(declaration_15.3, 
                    cluster_prob = seq(0.1, 0.9, 0.1))
diagnosis_15.3 <- diagnose_design(designs)
```


```{r, echo = FALSE, purl = FALSE}
diagnosis_15.3 <- get_rdddr_file_local("diagnosis_15.3")
```

![Trading off the number of clusters and the number of individuals per cluster](/figures/figure-15-3){#fig-ch15num3}

:::

## Design examples

- @stokes_2005 use a stratified cluster sampling design to estimate the prevalence of vote buying in Argentina. The strata were provinces, the clusters were census tracts. A simple random sample of individuals residing in selected census tracts were ultimately interviewed.

- @Paler2018 use a multistage clustered sampling design to study Lebanese citizen's willingness to sign a petition condemning sectarian politics. The clusters were localities (villages in rural areas, neighborhoods in urban areas), which were stratified by population size. Within selected localities, simple random samples of households were drawn; within households, a single adult was drawn at random. The study also included a randomized treatment that manipulated whether petition signatures were public or private. 
